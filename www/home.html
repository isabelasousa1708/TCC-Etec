<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naice App</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/home.css">
    <script src="https://cdnjs.deepai.org/deepai.min.js"></script>
    <script src="js/index.js"></script>
  </head>
  <body>
      <div id="home-container">
        <div class="app">
          <!--barra de menu-->  
          <ul class="menuBar">
           <div class="icon" >
              <li class="menuIcon"><a href=""><img src="img/menuIcon.png"/></a></li> 
              <li class="homeIcon"><a href=""><img src="img/homeIcon.png"/></a></li>
              <li class="configIcon"><a href="config.html"><img src="img/configIcon.png"/></a></li>
            </div>
         </ul>
    
         <script type="text/javascript">
            const CLIENT_ID ="0f6ee2b06618621";
            const gallery = document.getElementById('gallery');
            const doUpload = (url, options) => {
                  const promiseCallback = (resolve, reject) => {
                     fetch(url, options)
                     .then(response => response.json())
                     .then(resolve)
                     .catch(reject);
                    };
                 return new Promise (promiseCallback);
                } 
            const addImage = (url) =>{
                 gallery.innerHTML = `<img src="${url}" width="150" />`;
            }
            const onSuccess = (result) => {
                 const {data: {link} } = result;
                 console.log('link', link);
                 window.link = link ;   
                 addImage(link);
            };

            const uploadImage = (e) => {
             e.preventDefault();//nao faz submit
             const file = document.getElementById('file');
             //pegar o arquivo submetido com dat
             const data = new FormData();
             data.append('image', file.files[0]);
                 //fazer o upload.
             doUpload(' https://api.imgur.com/3/image/{id}',{
                  method: 'POST',
                  body: data,
                  headers: {
                     'Authorization':`Client-ID ${CLIENT_ID}`,
                    }
                })
             .then(onSuccess)
             .catch(console.error);
            };   
            const form = document.getElementById('upload-form');//pegando o form pelo ID
             form.addEventListener('submit',uploadImage)//  
         </script>
         <form id="upload-form" action="" method="POST" enctype="multipart/form-data">
            <label class="btn-upload">
                 <input type="file" id="file" name="file" name="submit">
                 <button class="btn"><img src="img/galleryIcon.png" ></button>
            </label>     
             <input type="submit" value="Upload image">
         </form>
         <div id="gallery">
            <!--imagem-->
         </div>
       </div>
        <button class="buttom-entrar" id="cameraApp" >CAMERA</button>
        <button type="button" onclick="compare();">comparar</button>
  </body>
</html>

